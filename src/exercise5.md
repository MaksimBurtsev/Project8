# PowerShell

## Что такое PowerShell

**```PowerShell```** — это мощная платформа управления и автоматизации задач в операционных системах Windows и Linux. Она предлагает средства командной строки, сценарии и интерактивную оболочку для выполнения различных операций без необходимости запуска графического интерфейса.

PowerShell поддерживает обработку объектов и позволяет создавать сильно типизированные объекты для передачи данных между командами. Эта особенность упрощает обработку вывода команд, особенно когда это касается объемных данных. PowerShell поддерживает также другие технологии Microsoft, такие как .NET и WMI, что позволяет работать с файлами и сетевыми ресурсами.

PowerShell позволяет автоматизировать рутинные задачи, такие как установка программ, создание пользователей и конфигурация сетевых настроек. С помощью PowerShell также можно производить мониторинг состояния системы, анализировать логи и генерировать отчеты.

PowerShell состоит из множества командлетов, которые могут быть скомбинированы в сценарии. Эти командлеты поддерживаются мощными функциями работы с потоками данных и управления ошибками. Кроме того, PowerSHell поддерживает модули — это готовые пакеты, которые содержат набор командлетов и функций для выполнения определенных задач. Занеси в таблицу
___
## Какие возможности имеет PowerShell

| **```Возможности PowerShell```** | **```Примеры использования```** |
| --- | --- |
| Менять настройки операционной системы | Изменение политики выполнения скриптов с помощью командлета Set-ExecutionPolicy |
| Управлять службами и процессами | Запуск и остановка службы с помощью командлетов Start-Service/Stop-Service |
| Настраивать роли и компоненты сервера | Установка компонентов с помощью командлета Install-WindowsFeature |
| Устанавливать программное обеспечение | Установка пакетов с NuGet с помощью командлета Install-Package |
| Управлять установленным ПО через специальные интерфейсы | Получение информации о файле или каталоге с помощью командлета Get-ChildItem |
| Встраивать исполняемые компоненты в сторонние программы | Встраивание скриптов PowerShell в программы на C# |
| Создавать сценарии для автоматизации задач администрирования | Создание сценария для резервного копирования данных |
| Работать с файловой системой, реестром Windows, хранилищем сертификатов и т.д. | Получение информации из реестра Windows с помощью командлета Get-ItemProperty |
___
## Как открыть журнал событий в PowerShell

Для того чтобы открыть журнал событий Windows PowerShell в PowerShell необходимо выполнить следующие действия:

1. Запустите PowerShell от имени администратора, нажав правой кнопкой мыши на значок PowerShell на панели задач и выбрав пункт "Запустить от имени администратора".

2. Введите следующую команду: `Get-EventLog -LogName "Windows PowerShell"`.

3. Нажмите клавишу "Enter", чтобы выполнить команду.

4. Будет выведен список всех событий, которые произошли в Windows PowerShell.

5. Вы можете изменить параметры команды, чтобы ограничить количество выводимых событий или отфильтровать их по некоторым критериям. Например, вы можете использовать параметр -Newest, чтобы вывести только последние добавленные записи.

6. Вы можете использовать команду Get-WmiObject вместо Get-EventLog, чтобы получить доступ к журналу событий через WMI. Для этого введите следующую команду: `Get-WmiObject Win32_NTLogEvent | where {$_.Logfile -eq "Windows PowerShell"}`.

7. Нажмите клавишу "Enter", чтобы выполнить команду. Вы получите список всех событий, произошедших в Windows PowerShell, включая дополнительную информацию, такую как дата и время события, и идентификатор события.

## Чем cmd отличается от PowerShell

| **```Отличия PowerShell от cmd```**  | **```Описание```**                                                             |
|----------------------------|----------------------------------------------------------------------|
| Синтаксис команд           | PowerShell использует синтаксис, основанный на объектно-ориентированной программировании, который позволяет использовать различные типы данных, создавать объекты и работать с ними. Cmd использует более простой набор команд, которые работают со строками и не имеют объектно-ориентированного подхода. |
| Поддержка dot sourcing     | PowerShell позволяет подключать внешние файлы скриптов с помощью команды "dot sourcing", что позволяет использовать код из других файлов в текущем скрипте. Cmd не имеет такой функциональности и код должен быть написан каждый раз заново. |
| Поддержка функций и скриптов | PowerShell поддерживает создание функций, скриптов и модулей, что позволяет создавать переиспользуемый код. Cmd не имеет такой поддержки и код должен быть написан каждый раз заново. |
| Поддержка алиасов          | PowerShell позволяет создать алиасы (сокращения) для длинных команд, что делает их более удобными и легкими в использовании. Cmd также поддерживает алиасы, но в минимальном объеме. |
| Поддержка комментариев     | PowerShell поддерживает комментарии, которые начинаются с символа "#", что позволяет добавлять пояснения к коду. Cmd не поддерживает комментарии. |
| Поддержка автодополнения   | PowerShell поддерживает автодополнение команд, аргументов, путей и т.д., что упрощает и ускоряет набор кода. Cmd также имеет автодополнение, но в намного меньшем объеме. |
| Поддержка интерфейса      | PowerShell поддерживает графический интерфейс пользователя (GUI), что упрощает взаимодействие с пользователем. Cmd не имеет графического интерфейса и должен быть выполнен через консоль. |
| Поддержка модулей          | PowerShell позволяет импортировать и использовать модули для выполнения различных задач, что упрощает обработку данных и ускоряет работу. Cmd не имеет такой поддержки модулей. |
| Поддержка многопоточности  | PowerShell позволяет выполнять команды в фоновом режиме в нескольких потоках одновременно, что ускоряет выполнение задач. Cmd не имеет такой поддержки многопоточности. |
| Наличие мощных инструментов| PowerShell имеет мощные инструменты для управления системой, такие как WMI, AD и Exchange, что делает его незаменимым инструментом для администраторов систем. Cmd не имеет таких мощных инструментов для управления системой. |
| Поддержка работы в Linux  | PowerShell работает в ОС Windows и Linux, что позволяет использовать один и тот же инструмент для автоматизации работы в различных операционных системах. Cmd не работает в Linux и используется только в ОС Windows. |
| Наличие интегрированной среды разработки | PowerShell включает в себя среду разработки PowerShell ISE, которая включает редактор кода, окно вывода и окно просмотра объектов. Cmd не имеет интегрированной среды разработки, но может быть использована любая другая среда разработки, такая как Visual Studio Code. |
| Обработка ошибок           | PowerShell позволяет обработать ошибки, возникающие во время выполнения кода, используя механизм Try-Catch-Finally, что позволяет обеспечить более гибкую и надежную обработку ошибок. Cmd также позволяет обработать ошибки, но использует более простой механизм обработки ошибок. |
| Ориентация на объекты       | PowerShell является объектно-ориентированным языком и позволяет работать с объектами, включая параметры, свойства и методы. Cmd не является объектно-ориентированным языком и не позволяет работать с объектами. |
| Поддержка командлетов       | PowerShell имеет более чем 3000 встроенных командлетов, что позволяет выполнять широкий диапазон задач, связанных с управлением системой. Cmd не имеет такого количества встроенных командлетов. |
| Наличие библиотеки .NET     | PowerShell позволяет работать с библиотекой .NET, что позволяет использовать множество возможностей .NET Framework для создания мощных и эффективных скриптов. Cmd не имеет поддержки библиотеки .NET. |
| Наличие пайплайна            | PowerShell имеет возможность использовать пайплайн, который позволяет передавать вывод команды как входной поток для другой команды, что упрощает манипуляции с данными. Cmd не имеет такой поддержки пайплайна. |
| Поддержка модуляции и расширяемости | PowerShell позволяет создавать собственные модули и расширять функциональность, что позволяет упростить и ускорить программирование. Cmd не имеет такой поддержки модулирования и расширяемости. |
| Наличие инструментов для управления серверами | PowerShell имеет много различных командлетов, которые позволяют легко управлять серверами, настройками диска, сетями и многими другими функциями. Cmd также имеет некоторые возможности для управления серверами, но они ограничены по сравнению с PowerShell. |
| Наличие полноценной консоли | PowerShell имеет полноценную консоль, которая может использоваться на равных с традиционной командной строкой Windows. Кроме того, PowerShell имеет множество расширений, которые добавляют множество дополнительных функций и возможностей для консоли. Cmd также имеет консоль, но она менее функциональна и гибкая, чем консоль PowerShell. |
| Скорость выполнения команд  | PowerShell имеет быстрое выполнение команд благодаря оптимизации скорости и улучшению алгоритмов. Это делает его удобным для обработки больших массивов данных и выполнения сложных задач. Cmd имеет медленное выполнение команд и не может обрабатывать такое количество данных, как PowerShell. |
| Расширенная поддержка сценариев | PowerShell позволяет создавать сложные сценарии, используя множество встроенных команд и возможностей, что позволяет ускорить процесс создания скриптов. Cmd работает только с простыми сценариями и имеет меньше возможностей для создания сложных сценариев. |
| Поддержка работающих процессов | PowerShell позволяет управлять работающими процессами и потоками, что позволяет быстро и легко контролировать работу системы. Cmd имеет некоторые возможности для управления процессами, но они ограничены по сравнению с PowerShell. |
| Поддержка remoting     | PowerShell имеет возможность удаленного управления компьютерами, что позволяет удаленно управлять компьютерами и упрощает работу с большим количеством компьютеров. Cmd не имеет такой поддержки удаленного управления. |

## Какой командой в PowerShell можно просмотреть список доступных журналов событий

| **```Команда```** | **```Описание```** |
|---------|-----------|
| ```Get-WinEvent -ListLog``` | **Выводит список доступных журналов событий** |
| ```Get-WinEvent –LogName ‘System’ –MaxEvents 10``` | **Выводит 10 последних записей журнала System** |
| ```Get-WinEvent –FilterHashTable @{LogName=’Security’;ID=4740}``` | **Выводит информацию о событиях журнала System с кодом 4740, генерация которых связана с блокировкой пользователя** |

## Какой командой можно узнать текущую версию PowerShell

**Команда** ```$PSVersionTable.PSVersion```

Пример выполнения команды:

```
$PSVersionTable.PSVersion
```

Результат может выглядеть, например, так:

```
Major  Minor  Build  Revision
-----  -----  -----  --------
5      1      19041  906